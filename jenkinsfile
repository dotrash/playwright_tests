pipeline {
   agent { docker { image 'mcr.microsoft.com/playwright:focal' } }
   stages {
      stage('install dependencies') {
         steps {
            sh 'npm install'
         }
      }
      stage('run tests') {
        steps {
            sh 'npx playwright test --reporter=line,html'
        }
      }
      stage('generate html report') {
        steps {
            sh 'npx playwright show-report'
        }
      }
      stage('open allure report') {
        steps {
            sh 'npx allure open ./allure-report'
        }
      }
   }
}